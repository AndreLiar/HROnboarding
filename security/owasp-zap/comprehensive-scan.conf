# OWASP ZAP Comprehensive Scan Configuration
# For thorough security testing of HR Onboarding Application

# Target configuration
TARGET_URL=https://hr-onboarding-dev-r2x0-api.azurewebsites.net
FRONTEND_URL=https://mango-pebble-0d01d2103.1.azurestaticapps.net

# Scan configuration
SCAN_LEVEL=comprehensive
SCAN_TIMEOUT=1800  # 30 minutes
MAX_DEPTH=10

# Authentication configuration
AUTH_METHOD=form
AUTH_URL=${TARGET_URL}/api/auth/login
AUTH_USERNAME_FIELD=email
AUTH_PASSWORD_FIELD=password
AUTH_USERNAME=${ZAP_AUTH_USERNAME}
AUTH_PASSWORD=${ZAP_AUTH_PASSWORD}

# Session management
SESSION_MANAGEMENT=cookie
SESSION_TOKEN_NAME=connect.sid

# API scanning configuration
API_SCAN=true
API_FORMAT=openapi
API_SPEC_URL=${TARGET_URL}/api-docs

# Comprehensive scanning
SPIDER_ENABLED=true
AJAX_SPIDER_ENABLED=true
PASSIVE_SCAN_ENABLED=true
ACTIVE_SCAN_ENABLED=true
FORCED_BROWSE_ENABLED=true

# Active scan policies
ACTIVE_SCAN_POLICY=Default Policy
INJECTION_TESTS=true
XSS_TESTS=true
CSRF_TESTS=true
DIRECTORY_TRAVERSAL_TESTS=true
SQL_INJECTION_TESTS=true

# Advanced options
BRUTE_FORCE_ENABLED=false  # Disabled to avoid account lockouts
DOS_TESTS_ENABLED=false    # Disabled for production environments

# Alert thresholds
FAIL_ON_HIGH=true
FAIL_ON_MEDIUM=true
FAIL_ON_LOW=false

# False positive management
EXCLUDE_CATEGORIES=""
EXCLUDE_CWES=""

# Exclusions
EXCLUDE_PATHS="/health,/metrics,/favicon.ico,/static/"
EXCLUDE_PARAMS="csrf_token,authenticity_token"

# Rate limiting
REQUEST_DELAY=100  # milliseconds between requests
THREADS=5

# Reporting
REPORT_FORMAT=html,json,xml,sarif
REPORT_DIR=/zap/wrk/reports

# Custom headers for authenticated requests
CUSTOM_HEADERS="X-Requested-With: XMLHttpRequest,Accept: application/json"

# Progress monitoring
PROGRESS_FILENAME=/zap/wrk/progress.log

# Technology detection
TECH_DETECTION=true

# Custom scan rules
CUSTOM_RULES_DIR=/zap/wrk/custom-rules